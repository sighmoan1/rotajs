<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.2/xlsx.full.min.js"></script>
    <style>
:root {
  --gap: 1.5rem;
  --page-padding: var(--gap);
  --sidebar: 15ch;
  --notsidebar: 75%;
  --maxcontent: 80ch;
  --theme-color: #D0021B    ;
  --theme-color-contrast: #FFFFFF;
  --theme-color-secondary: #5C7478;
  --color-meta: #E0E0E0;
}

/* Box sizing rules */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Remove default margin */
body,
h1,
h2,
h3,
h4,
p,
figure,
blockquote,
dl,
dd {
  margin: 0;
}

/* Remove list styles on ul, ol elements with a list role, which suggests default styling will be removed */
ul[role=list],
ol[role=list] {
  list-style: none;
}

/* Set core root defaults */
html:focus-within {
  scroll-behavior: smooth;
}

/* Set core body defaults */
body {
  min-height: 100vh;
  text-rendering: optimizeSpeed;
  line-height: 1.5;
}

/* A elements that don't have a class get default styles */
a:not([class]) {
  text-decoration-skip-ink: auto;
}

/* Make images easier to work with */
img,
picture {
  max-width: 100%;
  display: block;
}

/* Inherit fonts for inputs and buttons */
input,
button,
textarea,
select {
  font: inherit;
}

/* Remove all animations and transitions for people that prefer not to see them */
@media (prefers-reduced-motion: reduce) {
  html:focus-within {
    scroll-behavior: auto;
  }
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
body {
  margin: 0;
  line-height: 1.5;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: calc(0.9em + 0.3vw);
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 16px;
  line-height: 24px;
  font-weight: normal;
}
@media (min-width: 768px) {
  body {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 18px;
    line-height: 28px;
    font-weight: normal;
  }
}
@media (min-width: 1024px) {
  body {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 18px;
    line-height: 28px;
    font-weight: normal;
  }
}
body.body-xl {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 28px;
  line-height: 32px;
  font-weight: normal;
}
@media (min-width: 768px) {
  body.body-xl {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 38px;
    line-height: 56px;
    font-weight: normal;
  }
}
@media (min-width: 1024px) {
  body.body-xl {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 38px;
    line-height: 56px;
    font-weight: normal;
  }
}
body.body-xl.bold {
  font-weight: bold;
}
body.body-lg {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 18px;
  line-height: 28px;
  font-weight: normal;
}
@media (min-width: 768px) {
  body.body-lg {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 22px;
    line-height: 32px;
    font-weight: normal;
  }
}
@media (min-width: 1024px) {
  body.body-lg {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 22px;
    line-height: 32px;
    font-weight: normal;
  }
}
body.body-lg.bold {
  font-weight: bold;
}
body.small-print {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  line-height: 20px;
  font-weight: normal;
}
@media (min-width: 768px) {
  body.small-print {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 14px;
    line-height: 20px;
    font-weight: normal;
  }
}
@media (min-width: 1024px) {
  body.small-print {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 14px;
    line-height: 20px;
    font-weight: normal;
  }
}
body.tiny {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 12px;
  line-height: 12px;
  font-weight: normal;
}
@media (min-width: 768px) {
  body.tiny {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    line-height: 12px;
    font-weight: normal;
  }
}
@media (min-width: 1024px) {
  body.tiny {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    line-height: 12px;
    font-weight: normal;
  }
}

/* Body XL */
.body-xl {
  font-size: 28px;
  line-height: 32px;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body-xl {
    font-size: 38px;
    line-height: 56px;
  }
}
.body-xl-bold {
  font-size: 28px;
  line-height: 32px;
  font-weight: bold;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body-xl-bold {
    font-size: 38px;
    line-height: 56px;
    font-weight: bold;
  }
}
/* Body Large */
.body-large {
  font-size: 18px;
  line-height: 28px;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body-large {
    font-size: 22px;
    line-height: 32px;
  }
}
.body-large-bold {
  font-size: 18px;
  line-height: 28px;
  font-weight: bold;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body-large-bold {
    font-size: 22px;
    line-height: 32px;
    font-weight: bold;
  }
}
/* Body */
.body, p {
  font-size: 16px;
  line-height: 24px;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body, p {
    font-size: 18px;
    line-height: 28px;
  }
}
.body-bold {
  font-size: 16px;
  line-height: 24px;
  font-weight: bold;
}

@media (min-width: 768px) { /* Tablet and Desktop */
  .body-bold {
    font-size: 18px;
    line-height: 28px;
    font-weight: bold;
  }
}
/* SmallPrint */
.smallprint {
  font-size: 14px;
  line-height: 20px;
}

.smallprint-bold {
  font-size: 14px;
  line-height: 20px;
  font-weight: bold;
}

/* Tiny */
.tiny {
  font-size: 12px;
  line-height: 12px;
}

.tiny-bold {
  font-size: 12px;
  line-height: 12px;
  font-weight: bold;
}

article > * + * {
  margin-block-start: var(--gap);
}

h1 {
  margin-top: 0;
  padding-top: 0;
  padding-bottom: 0.2rem;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 30px;
  line-height: 36px;
  font-weight: bold;
}
@media (min-width: 768px) {
  h1 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 44px;
    line-height: 50px;
    font-weight: bold;
  }
}
@media (min-width: 1024px) {
  h1 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 44px;
    line-height: 50px;
    font-weight: bold;
  }
}

h2 {
  margin-block: 0;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 26px;
  line-height: 32px;
  font-weight: bold;
}
@media (min-width: 768px) {
  h2 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 28px;
    line-height: 32px;
    font-weight: bold;
  }
}
@media (min-width: 1024px) {
  h2 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 28px;
    line-height: 32px;
    font-weight: bold;
  }
}

h3 {
  margin-block: 0;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 20px;
  line-height: 28px;
  font-weight: bold;
}
@media (min-width: 768px) {
  h3 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 24px;
    line-height: 32px;
    font-weight: bold;
  }
}
@media (min-width: 1024px) {
  h3 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 24px;
    line-height: 32px;
    font-weight: bold;
  }
}

h4, h5, h6 {
  margin-block: 0;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  line-height: 20px;
  font-weight: bold;
}
@media (min-width: 768px) {
  h4, h5, h6 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 18px;
    line-height: 28px;
    font-weight: bold;
  }
}
@media (min-width: 1024px) {
  h4, h5, h6 {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 18px;
    line-height: 28px;
    font-weight: bold;
  }
}

.heading-wrapper {
  margin-top: calc(2 * var(--gap));
  margin-bottom: 0;
  display: grid;
  grid-template-columns: minmax(auto, max-content) min-content;
  gap: calc(var(--gap) / 2);
  align-items: baseline;
}

.deeplink {
  font-size: 1.5rem;
}
.deeplink:link, .deeplink:visited {
  padding: 0 0.75rem;
  border-radius: 100%;
  color: var(--color-meta);
  text-decoration: none;
}
.deeplink:hover, .deeplink:focus {
  color: var(--theme-color-contrast);
  background-color: var(--theme-color);
}

a {
  color: #1D70B8;
  text-decoration: underline;
  font-weight: bold;
  text-decoration-thickness: 3px;
  text-underline-offset: 5px;
}
a:hover, a:focus {
  text-decoration-thickness: 3px;
  color: #003078;
}

a[href^="https://"]:not([href^="https://pack11ty.dev"]):not(.button):not(.install) {
  padding-right: 15px;
  background-position: top 0.1em right;
  background-size: 12px 12px;
  background-repeat: no-repeat;
  background-image: url("/images/external-link-blue.svg");
}
footer a[href^="https://"]:not([href^="https://pack11ty.dev"]):not(.button):not(.install) {
  background-image: url("/images/external-link-white.svg");
}

ul {
  margin: 0;
  margin-top: 0.25rem;
  padding: 0;
  list-style: none;
}

li {
  margin: 0 0 0 1.5em;
}

ol {
  margin-bottom: 1rem;
  padding-left: 0rem;
}
ol li {
  margin-bottom: 0.5rem;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 18px;
  line-height: 24px;
  font-weight: normal;
}

main ul {
  margin-bottom: 1rem;
  padding-left: 1.5rem;
}
main ul li {
  margin-bottom: 0.5rem;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  line-height: 24px;
  font-weight: normal;
}
main ul li::before {
  content: "";
  display: inline-block;
  width: 10px;
  height: 10px;
  margin-right: 10px;
  background-color: var(--theme-color);
  border-radius: 50%;
  margin-left: -20px
}

table {
  border-collapse: collapse;
  border-spacing: 0;
  font-feature-settings: "tnum" 1;
}
@supports (font-variant-numeric: tabular-nums) {
  table {
    font-feature-settings: normal;
    font-variant-numeric: tabular-nums;
  }
}

thead {
  background-color: #eee;
}
thead th {
  text-align: left;
  vertical-align: bottom;
}

th,
td {
  padding: 0.3em 0.5em;
  border: 1px solid #ccc;
  vertical-align: top;
}

img {
  max-width: 100%;
  height: auto;
}

figure {
  clear: both;
  display: block;
  margin: var(--gap) auto;
}

figure {
  text-align: center;
}
figure img {
  margin-top: 0;
  margin-bottom: 0;
  padding: 0;
}

figcaption {
  display: inline-block;
  text-align: left;
  font-size: smaller;
  font-style: italic;
  margin: 0.1em 1em;
  padding: 0.3em 0;
  color: #666;
}
figcaption p {
  margin: 0;
}

main {
  max-width: var(--maxcontent);
}

main > * + * {
  margin-top: var(--gap);
}

/* mark element */
mark::before,
mark::after {
  content: " [highlight start] ";
  clip-path: inset(100%);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  width: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
}

mark::after {
  content: " [highlight end] ";
}

sub,
sup {
  position: relative;
  font-size: 75%;
  line-height: 0;
  vertical-align: baseline;
}

sup {
  top: -0.5em;
}

sub {
  bottom: -0.25em;
}

.menu {
  display: none;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  text-align: center;
}
.menu div {
  width: 25px;
  height: 3px;
  background-color: black;
  margin: 4px 0;
}
.menu span {
  display: block;
  font-size: 14px;
  font-weight: bold;
  margin-top: 8px;
}

.menu-toggle {
  display: none;
}

/* Style for the navigation */
.nav-menu {
  list-style: none;
  display: flex;
  gap: 15px;
  z-index: 1000;
}

.nav-menu a {
  text-decoration: none;
  color: black;
  font-weight: bold;
}

.nav-menu a:hover {
  text-decoration: underline;
}

/* Media query for mobile view  (made permanent)*/
/* @media (max-width: 600px) { */
.menu {
  display: flex;
}

.nav-menu {
  display: none;
  flex-direction: column;
  position: absolute;
  top: 60px;
  right: 20px;
  background-color: white;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  padding: 10px;
}

.menu-toggle:checked + .menu + .nav-menu {
  display: flex;
}

/* } */
details {
  border: 1px solid #183251;
  border-radius: 4px;
  margin-bottom: 1rem;
  overflow: hidden;
}

summary {
  background-color: #183251;
  color: white;
  padding: 1rem;
  cursor: pointer;
  position: relative;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 16px;
  line-height: 24px;
  font-weight: bold;
}

details[open] summary::after {
  transform: rotate(-180deg);
}

details > div {
  padding: 1rem;
  background-color: white;
  border-top: 1px solid #183251;
}

details ul {
  margin: 1rem 3rem 1rem 0rem;
  padding-left: 1rem;
  text-indent: -1rem;
  list-style-position: outside;
}
details ul li {
  margin-bottom: 0.5rem;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 16px;
  line-height: 24px;
  font-weight: normal;
}
details ul li::before {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  margin-right: 8px;
  background-color: var(--theme-color);
  border-radius: 50%;
}

/*
Every Layout's cluster layout:
https://absolutely.every-layout.dev/layouts/cluster/
*/
.cluster {
  overflow: hidden;
}

.cluster > * {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  margin: calc(var(--gap) / 2 * -1);
}

.cluster > * > * {
  margin: calc(var(--gap) / 2);
}

/*
Every Layout's stack layout:
https://absolutely.every-layout.dev/layouts/stack/
*/
.stack > * + * {
  margin-top: var(--gap);
}

.page {
  margin: var(--gap);
  max-width: 700px;
  display: flex;
  flex-direction: column;
  min-height: calc(100vh - 2 * var(--gap));
}

.button {
  display: inline-block;
  margin: 0 var(--gap) var(--gap) 0;
  padding: 0.2em 0.7em;
  font-size: smaller;
  white-space: nowrap;
  text-decoration: none;
  border: 1px solid rgba(27, 31, 35, 0.2);
  border-radius: 0.25em;
  color: #fff;
}
.button:hover {
  opacity: 0.8;
}

.github {
  background-color: #1e7b33;
  background-image: linear-gradient(-180deg, #1e7b33, #19672a 90%);
}

.netlify {
  background-color: #2e51ed;
  background-image: linear-gradient(-180deg, #2e51ed, #1d40dc 90%);
}

.vercel {
  background-color: #000;
}

.stackblitz {
  background-color: #1c2025;
}

.install {
  display: inline-block;
  margin: 0 var(--gap) var(--gap) 0;
}

header > * {
  align-items: baseline;
}

.sitelogo-parent {
  flex-grow: 1;
}

.sitelogo {
  margin: 0;
  padding: 0.2rem 1rem;
  font-size: 2rem;
  font-weight: bold;
  color: var(--theme-color-contrast);
  background-color: var(--theme-color);
  border-bottom: 2px solid var(--theme-color);
}
.sitelogo a {
  color: var(--theme-color-contrast);
}
.sitelogo a:hover {
  text-decoration: underline;
}

nav {
  --gap: 0.5rem;
}
nav ul {
  list-style-type: none;
  padding: 0;
}
nav li {
  flex-grow: 1;
  text-align: center;
}
nav a {
  display: block;
  padding: 0.1em 0.5em;
  color: var(--theme-color);
  background-color: #ddd;
  border: 2px solid #ddd;
}
nav .githubstars {
  padding: 0.1em;
  line-height: 1;
}
nav a:hover {
  color: var(--theme-color-contrast);
  background-color: var(--theme-color);
  border-color: var(--theme-color);
}
nav .current a {
  text-decoration: none;
  font-weight: bold;
  border-color: var(--theme-color);
}
nav .current a:hover {
  text-decoration: underline;
}
nav .offline {
  display: none;
}
nav .offline a {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
body.offline nav .offline {
  display: block;
}

.pack11ty {
  margin: 0 0.1em;
  padding: 0.1em 0.3em;
  color: var(--theme-color-contrast);
  background-color: var(--theme-color);
}

img.logo {
  max-width: 50%;
}
@media (min-width: 20em) {
  img.logo {
    max-width: 33%;
    float: right;
    margin: 0 0 var(--gap) var(--gap);
  }
}
@media (min-width: 30em) {
  img.logo {
    max-width: 25%;
  }
}

.logo {
  display: block;
  margin: var(--gap) auto;
}

/* @media (max-width: 600px) { */
.logo-svg {
  padding-right: 4rem;
}

.sitelogo-parent {
  text-align: center; /* Optional: Center the logo */
  max-width: 320px;
}

/*  } */
.news__title {
  border-bottom: none;
  margin: 0;
}

.news__meta {
  margin: 0;
  font-size: 0.9em;
  color: var(--color-meta);
}

.video iframe {
  max-width: 100%;
}

.onpagenav {
  list-style: none;
  margin: 0;
  padding: 0;
}
.onpagenav li {
  border-bottom: 1px solid #ddd;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  margin: 0 0 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: large;
  cursor: pointer;
}
.onpagenav li:hover {
  background-color: #f5f5f5;
}
.onpagenav li a {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 18px;
  line-height: 28px;
  font-weight: normal;
  color: black;
  text-decoration: none;
  flex-grow: 1;
}
.onpagenav li .arrow {
  font-size: 3rem;
  color: #000;
}

.backnext-link {
  display: flex;
  align-items: center;
}

.backnext-link {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1.25rem;
}

.backnext-icon {
  width: 24px;
  height: 24px;
  fill: rgb(38, 38, 38); /* Use the color from the original inline style */
  margin-right: 8px; /* Adjust the spacing between the icon and text as needed */
}

.banner {
  background-color: #4CAF50; /* Change to your preferred color */
  color: white;
  text-align: center;
  padding: 10px 0;
  font-size: 18px;
  font-weight: bold;
}

.visually-hidden:not(:focus):not(:active) {
  /* elementProperties */
  position: absolute;
  /* Box Model */
  width: 1px;
  height: 1px;
  /* Typography */
  white-space: nowrap;
  /* Visual */
  overflow: hidden;
  /* Clip */
  clip-path: inset(50%);
}

    </style>
    <script>
        function handleFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);

                    generateSchedule(jsonData);
                };
                reader.readAsArrayBuffer(file);
            }
        }

        function generateSchedule(data) {
            // Constants
            const DAYS = 366;
            const TL_SHIFTS_PER_DAY = 2;
            const DM_SHIFTS_PER_DAY = 2;

            // Load people data
            const people = data.map(row => ({
                name: row['name'],
                can_do_tl: row['can_do_tl'],
                can_do_dm: row['can_do_dm']
            }));

            function allocateShifts(people, days, shiftsPerDay, eligibleKey, shiftKeys) {
                const eligible = people.filter(p => p[eligibleKey] === 'Y').map(p => p.name);
                const shiftsPerPerson = Object.fromEntries(eligible.map(name => [name, 0]));
                const schedule = Array.from({ length: days }, () => Object.fromEntries(shiftKeys.map(key => [key, null])));

                let index = 0;
                for (let day = 0; day < days; day++) {
                    for (let shift = 0; shift < shiftsPerDay; shift++) {
                        const person = eligible[index % eligible.length];
                        schedule[day][shiftKeys[shift]] = person;
                        shiftsPerPerson[person]++;
                        index++;
                    }
                }
                return { schedule, shiftsPerPerson };
            }

            function allocateDmShifts(people, days, tlSchedule) {
                const eligible = people.filter(p => p.can_do_dm === 'Y' && p.can_do_tl === 'N').map(p => p.name);
                const shiftsPerPerson = Object.fromEntries(eligible.map(name => [name, 0]));

                let index = 0;
                for (let day = 0; day < days; day++) {
                    for (let shift = 0; shift < DM_SHIFTS_PER_DAY; shift++) {
                        const person = eligible[index % eligible.length];
                        if (tlSchedule[day]['TL1'] !== person && tlSchedule[day]['TL2'] !== person) {
                            tlSchedule[day][`DM${shift + 1}`] = person;
                            shiftsPerPerson[person]++;
                            index++;
                        }
                    }
                }
                return { schedule: tlSchedule, shiftsPerPerson };
            }

            const { schedule: tlSchedule, shiftsPerPerson: tlShifts } = allocateShifts(people, DAYS, TL_SHIFTS_PER_DAY, 'can_do_tl', ['TL1', 'TL2']);
            const { schedule: fullSchedule, shiftsPerPerson: dmShifts } = allocateDmShifts(people, DAYS, tlSchedule);

            const scheduleData = fullSchedule.map((shifts, day) => ({
                Day: day + 1,
                'TL Shift 1': shifts['TL1'],
                'TL Shift 2': shifts['TL2'],
                'DM Shift 1': shifts['DM1'] || '',
                'DM Shift 2': shifts['DM2'] || ''
            }));

            const summaryData = people.map(person => ({
                Name: person.name,
                'Can Do TL': person.can_do_tl,
                'Can Do DM': person.can_do_dm,
                'Total TL Shifts': tlShifts[person.name] || 0,
                'Total DM Shifts': dmShifts[person.name] || 0,
                'Total Shifts': (tlShifts[person.name] || 0) + (dmShifts[person.name] || 0)
            }));

            // Display tables
            displayTable('schedule-table', scheduleData);
            displayTable('summary-table', summaryData);

            // Create download button
            const downloadBtn = document.createElement('button');
            downloadBtn.textContent = 'Download Schedule';
            downloadBtn.onclick = function() {
                const wb = XLSX.utils.book_new();
                const ws1 = XLSX.utils.json_to_sheet(scheduleData);
                XLSX.utils.book_append_sheet(wb, ws1, 'Schedule');

                const ws2 = XLSX.utils.json_to_sheet(summaryData);
                XLSX.utils.book_append_sheet(wb, ws2, 'Summary');

                const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
                const blob = new Blob([wbout], { type: 'application/octet-stream' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'schedule.xlsx';
                a.click();
                window.URL.revokeObjectURL(url);
            };

            document.getElementById('results').appendChild(downloadBtn);
        }

        function displayTable(tableId, data) {
            const table = document.getElementById(tableId);
            table.innerHTML = '';

            if (data.length === 0) {
                table.innerHTML = '<p>No data available</p>';
                return;
            }

            const headers = Object.keys(data[0]);
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');

            const headerRow = document.createElement('tr');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);

            data.forEach(row => {
                const tr = document.createElement('tr');
                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = row[header];
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            table.appendChild(thead);
            table.appendChild(tbody);
        }
    </script>
</head>



<body>
    <div class="page">

      <div class="with-sidebar">
        <div>
          <div class="sidebar">

            <header role="banner" class="cluster">
              <div>
                <div class="sitelogo-parent">          
                  <a href="/" aria-label="Home">
                  <svg class="logo-svg" aria-hidden="true" focusable="false" aria-labelledby="title" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="21 20 298 62" xml:space="preserve"><style>.st0{fill:#fff}</style><path d="M62 40.7V20.1H41.3v20.6H20.7v20.7h20.6v20.5H62V61.4h20.6V40.7z" style="fill:#ee2a24"></path><path d="M103.2 52.1h4.9c1.9 0 3.3.8 3.3 2.9 0 2.1-1.6 2.8-3.4 2.8h-4.8v-5.7zm-4.5 9.3h10c3.7 0 7.3-1.8 7.3-6 0-2.6-1.3-4.5-3.8-5.2 1.8-.9 2.8-2.3 2.8-4.3 0-3.8-2.6-5.1-6.6-5.1h-9.7v20.6zm4.5-17.2h4.2c1.6 0 3.1.4 3.1 2.4 0 1.7-1.2 2.5-2.8 2.5h-4.6v-4.9zm14.6 2.2h3.9v2.8h.1c.8-1.9 2.7-3.2 4.7-3.2.3 0 .6.1.9.1V50c-.4-.1-1-.1-1.5-.1-3 0-4 2.2-4 4.8v6.8h-4.1V46.4zm11.6 0h4.1v15h-4.1v-15zm4.1-2.3h-4.1v-3.4h4.1v3.4zm8.7 2.3h3v2.8h-3v7.4c0 1.4.4 1.8 1.7 1.8.4 0 .8 0 1.3-.1v3.2c-.7.1-1.5.1-2.4.1-2.5 0-4.7-.6-4.7-3.6v-8.8h-2.5v-2.8h2.5v-4.5h4.1v4.5zm5.9 0h4.1v15h-4.1v-15zm4.2-2.3h-4.1v-3.4h4.1v3.4zm5.6 12.4c0 1.8 1.5 2.5 3.2 2.5 1.2 0 2.7-.5 2.7-1.9 0-1.3-1.7-1.7-4.6-2.3-2.4-.5-4.8-1.4-4.8-4 0-3.8 3.3-4.8 6.5-4.8s6.3 1.1 6.6 4.8h-3.9c-.1-1.6-1.3-2-2.8-2-.9 0-2.3.2-2.3 1.4 0 1.5 2.3 1.7 4.7 2.2 2.4.5 4.7 1.4 4.7 4.2 0 4-3.4 5.2-6.8 5.2-3.5 0-6.9-1.3-7.1-5.3h3.9zm11.7-15.8h4.1v7.8h.1c1-1.7 2.8-2.5 4.4-2.5 4.4 0 5.4 2.5 5.4 6.2v9.2h-4.1v-8.5c0-2.5-.7-3.7-2.6-3.7-2.2 0-3.2 1.2-3.2 4.3v7.9h-4.1V40.7zm23 3.5h5c2 0 3.1.9 3.1 2.9 0 2.1-1.1 3-3.1 3h-5v-5.9zm-4.5 17.2h4.5v-8.1h4.6c2.3 0 3.1 1 3.5 3.1.2 1.7.2 3.7.7 5h4.5c-.8-1.2-.8-3.6-.9-4.9-.1-2.1-.8-4.2-3-4.8v-.1c2.2-.9 3.2-2.7 3.2-5.2 0-3.1-2.3-5.7-6-5.7h-11.1v20.7zm22.5-9.1c.1-1.2.8-3.2 3.4-3.2 2 0 2.9 1.1 3.3 3.2h-6.7zm10.8 2.6c.3-4.6-2.2-8.9-7.3-8.9-4.5 0-7.6 3.4-7.6 7.9 0 4.6 2.9 7.9 7.6 7.9 3.4 0 5.9-1.5 7-5.1h-3.6c-.3 1-1.6 2-3.2 2-2.3 0-3.5-1.2-3.6-3.8h10.7zm12.7-1.1c0 2.4-.8 4.8-3.5 4.8-2.6 0-3.6-2.5-3.6-4.8 0-2.5.9-4.8 3.6-4.8 2.6.1 3.5 2.4 3.5 4.8zm0 7.6h3.9V40.7h-4.1v7.5h-.1c-1-1.5-2.7-2.2-4.4-2.2-4.4 0-6.6 3.7-6.6 7.8s2.2 8 6.7 8c1.9 0 3.6-.7 4.5-2.3h.1v1.9zm21.7-13.8c-.3-2.1-2.3-3.6-4.5-3.6-4 0-5.6 3.5-5.6 7.1 0 3.5 1.5 6.9 5.6 6.9 2.8 0 4.4-1.9 4.7-4.6h4.4c-.5 5.2-4 8.5-9.1 8.5-6.4 0-10.1-4.8-10.1-10.8 0-6.1 3.7-10.9 10.1-10.9 4.6 0 8.4 2.6 8.9 7.4h-4.4zm6.5-1.2h3.9v2.8h.1c.8-1.9 2.8-3.2 4.8-3.2.3 0 .6.1.9.1V50c-.4-.1-1-.1-1.5-.1-3 0-4 2.2-4 4.8v6.8h-4.1V46.4zm14.3 7.5c0-2.4.8-4.8 3.6-4.8s3.6 2.4 3.6 4.8-.8 4.8-3.6 4.8-3.6-2.5-3.6-4.8zm-4.2 0c0 4.8 3 7.9 7.7 7.9s7.8-3.1 7.8-7.9c0-4.8-3-7.9-7.8-7.9-4.6 0-7.7 3.1-7.7 7.9zm20.8 2.6c0 1.8 1.5 2.5 3.2 2.5 1.2 0 2.7-.5 2.7-1.9 0-1.3-1.7-1.7-4.7-2.3-2.4-.5-4.7-1.4-4.7-4 0-3.8 3.3-4.8 6.5-4.8 3.3 0 6.3 1.1 6.6 4.8h-3.9c-.1-1.6-1.3-2-2.8-2-.9 0-2.3.2-2.3 1.4 0 1.5 2.3 1.7 4.7 2.2 2.4.5 4.7 1.4 4.7 4.2 0 4-3.4 5.2-6.8 5.2-3.5 0-6.8-1.3-7-5.3h3.8zm15.2 0c0 1.8 1.5 2.5 3.1 2.5 1.2 0 2.7-.5 2.7-1.9 0-1.3-1.7-1.7-4.7-2.3-2.3-.5-4.7-1.4-4.7-4 0-3.8 3.3-4.8 6.5-4.8 3.3 0 6.3 1.1 6.6 4.8H314c-.1-1.6-1.3-2-2.8-2-.9 0-2.2.2-2.2 1.4 0 1.5 2.3 1.7 4.6 2.2 2.4.5 4.8 1.4 4.8 4.2 0 4-3.4 5.2-6.9 5.2-3.4 0-6.8-1.3-7-5.3h3.9z" style="fill:#231f20"></path></svg></a>
                </div>
              </div>
              <br>
            </header>
          </div>
          <div class="not-sidebar">
            <main role="main">  
    <h1>Schedule Generator</h1>
    <p>You need to provide a .csv file in a format like<p>
<table>
  <tr>
    <thead>
    <th>name</th>
    <th>can_do_dm</th>
    <th>can_do_tl</th>
  </thead>
  </tr>
  <tr>
    <td>Alice</td>
    <td>Y</td>
    <td>N</td>
  </tr>
    <tr>
    <td>Bob</td>
    <td>Y</td>
    <td>Y</td>
  </tr>
</table>
<p>This all runs in your browser, your file isn't uploaded anywhere</p>
    <input type="file" accept=".csv" onchange="handleFile(event)" />
    <div id="results">
        <h2>Schedule</h2>
        <table id="schedule-table"></table>
        <br>
        <h2>Shift Distribution</h2>
        <table id="summary-table"></table>
</div>
</main>
</div>
</div>
</div>
</div>
  </body>
</html>